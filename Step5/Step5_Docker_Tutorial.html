<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Step 5 è©³ç´°ã‚¬ã‚¤ãƒ‰: CI/CD (è‡ªå‹•åŒ–ã®å·¥å ´)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: "GitHub Actions". Background: Cool Gray (#f0f6fc). Accents: Action Blue (#2088ff) & Success Green (#2ea44f). -->
    <!-- Application Structure Plan: Consistent with previous steps.
         - Key Change: Introduction of ".github/workflows" concept.
         - Key Change: Simulation of "git push" triggering a remote build.
         - Key Change: Visual "Pipeline" animation showing the build process stages.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f0f6fc; /* GitHub-like light bg */
            color: #24292f;
        }
        .font-mono {
            font-family: 'Fira Code', monospace;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 250px;
            max-height: 300px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 300px;
            }
        }
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        .typing-effect {
            overflow: hidden;
            white-space: nowrap;
            border-right: 2px solid transparent;
            animation: typing 2s steps(40, end);
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in forwards;
            opacity: 0;
        }
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        .step-btn.active {
            background-color: #ddf4ff; /* Light Blue */
            border-left: 4px solid #0969da;
            color: #0969da;
        }
        .step-btn {
            border-left: 4px solid transparent;
        }
        /* Pipeline Animation Styles */
        .pipeline-node {
            transition: all 0.5s ease;
        }
        .pipeline-line {
            transition: all 0.5s ease;
            height: 4px;
            background-color: #d0d7de;
        }
        .pipeline-node.completed {
            background-color: #2ea44f;
            color: white;
            border-color: #2ea44f;
        }
        .pipeline-node.running {
            background-color: #bf8700; /* Yellow/Orange */
            color: white;
            border-color: #bf8700;
            animation: pulse 1s infinite;
        }
        .pipeline-line.completed {
            background-color: #2ea44f;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 z-10 flex-none">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <span class="text-3xl">ğŸ­</span>
                <div>
                    <h1 class="text-xl font-bold text-slate-800 leading-none">Step 5: è‡ªå‹•åŒ–ã®å·¥å ´ã‚’ä½œã‚‹</h1>
                    <p class="text-xs text-slate-500 mt-1">CI/CD & GitHub Actions ãƒãƒ³ã‚ºã‚ªãƒ³</p>
                </div>
            </div>
            <div class="hidden md:block">
                <div class="flex items-center space-x-2 text-sm text-slate-500">
                    <span>Progress:</span>
                    <div class="w-32 h-2 bg-slate-100 rounded-full overflow-hidden">
                        <div id="progress-bar" class="h-full bg-green-500 transition-all duration-500" style="width: 0%"></div>
                    </div>
                    <span id="progress-text">0%</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Workspace -->
    <div class="flex-grow flex flex-col md:flex-row overflow-hidden max-w-7xl mx-auto w-full">
        
        <!-- Sidebar Navigation -->
        <nav class="w-full md:w-64 bg-white border-r border-slate-200 flex-none overflow-y-auto z-0">
            <div class="p-4 space-y-1">
                <button onclick="loadStep(0)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-0">
                    <span>1. ã‚³ãƒ³ã‚»ãƒ—ãƒˆ</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Intro</span>
                </button>
                <button onclick="loadStep(1)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-1">
                    <span>2. è¨­è¨ˆå›³ã‚’æ›¸ã</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">YAML</span>
                </button>
                <button onclick="loadStep(2)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-2">
                    <span>3. Push & Trigger</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Git</span>
                </button>
                <button onclick="loadStep(3)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-3">
                    <span>4. è‡ªå‹•ãƒ“ãƒ«ãƒ‰ä½“é¨“</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Run</span>
                </button>
                <button onclick="loadStep(4)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-4">
                    <span>5. æˆæœç‰©ç¢ºèª</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Verify</span>
                </button>
                <button onclick="loadStep(5)" class="step-btn w-full text-left px-4 py-3 rounded hover:bg-slate-50 transition-colors font-medium text-slate-600 flex items-center justify-between" id="btn-step-5">
                    <span>6. ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—å®Œäº†</span>
                    <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-400">Goal</span>
                </button>
            </div>
            
            <div class="p-4 mt-4 border-t border-slate-100">
                <div class="bg-gray-100 p-3 rounded text-sm text-gray-800 border border-gray-200">
                    <p class="font-bold mb-1">â–¶ Actions</p>
                    <p id="step-hint">GitHubãŒæä¾›ã™ã‚‹ã€ã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã®è‡ªå‹•åŒ–ãƒ­ãƒœãƒƒãƒˆã§ã™ã€‚</p>
                </div>
            </div>
        </nav>

        <!-- Content Area -->
        <main class="flex-grow bg-slate-50 overflow-y-auto p-4 md:p-8 relative" id="main-content">
            <!-- Dynamic Content injected here -->
        </main>

    </div>

    <!-- Scripts -->
    <script>
        // --- DATA & CONTENT ---
        const tutorialSteps = [
            {
                id: "concept",
                title: "1. æœ€å¾Œã®ãƒ”ãƒ¼ã‚¹ï¼šCI/CD",
                content: `
                    <div class="max-w-3xl mx-auto space-y-8 animate-fade-in">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800 mb-4">ã€Œæ‰‹ä½œã‚Šã€ã‹ã‚‰ã€Œå·¥å ´ç”Ÿç”£ã€ã¸</h2>
                            <p class="text-lg text-slate-600 mb-6">
                                ã“ã‚Œã¾ã§ã¯ã€ã‚ãªãŸã®PCã§ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã£ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œã£ã¦ã„ã¾ã—ãŸï¼ˆæ‰‹ä½œã‚Šï¼‰ã€‚<br>
                                Step 5ã§ã¯ã€ã‚³ãƒ¼ãƒ‰ã‚’GitHubã«é€ã‚‹ã ã‘ã§ã€ã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã®ã‚µãƒ¼ãƒãƒ¼ãŒå‹æ‰‹ã«ãƒ†ã‚¹ãƒˆã—ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ãã‚Œã‚‹ä»•çµ„ã¿ï¼ˆå·¥å ´ï¼‰ã‚’ä½œã‚Šã¾ã™ã€‚
                            </p>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 text-center opacity-70">
                                <div class="text-4xl mb-4">âœ‹</div>
                                <h3 class="font-bold text-slate-700 mb-2">æ‰‹å‹•ãƒ“ãƒ«ãƒ‰</h3>
                                <p class="text-sm text-slate-500 text-left px-4">
                                    ãƒ»<code>docker build</code> ã‚’æ¯å›å©ã<br>
                                    ãƒ»æ‹…å½“è€…ã®PCãŒå£Šã‚ŒãŸã‚‰ãƒ“ãƒ«ãƒ‰ã§ããªã„<br>
                                    ãƒ»ã€Œç§ã®ç’°å¢ƒã§ã¯å‹•ã„ãŸã€å•é¡ŒãŒæ®‹ã‚‹
                                </p>
                            </div>
                            <div class="bg-blue-50 p-6 rounded-xl shadow-md border border-blue-200 text-center relative">
                                <div class="absolute -top-3 -right-3 bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow">CI/CD</div>
                                <div class="text-4xl mb-4">ğŸ¤–</div>
                                <h3 class="font-bold text-blue-800 mb-2">è‡ªå‹•ãƒ“ãƒ«ãƒ‰ (CI)</h3>
                                <p class="text-sm text-blue-800 text-left px-4">
                                    ãƒ»ã‚³ãƒ¼ãƒ‰ã‚’Pushã™ã‚‹ã ã‘<br>
                                    ãƒ»ã‚¯ãƒªãƒ¼ãƒ³ãªç’°å¢ƒã§æ¯å›ãƒ“ãƒ«ãƒ‰<br>
                                    ãƒ»<span class="font-bold">èª°ã§ã‚‚ãƒ»ã„ã¤ã§ã‚‚ãƒ»åŒã˜å“è³ª</span>
                                </p>
                            </div>
                        </div>

                        <div class="bg-gray-800 text-white p-4 rounded-xl flex items-center shadow-lg">
                            <span class="text-2xl mr-4">ğŸ­</span>
                            <div>
                                <h4 class="font-bold text-sm">GitHub Actions</h4>
                                <p class="text-xs text-gray-300 mt-1">
                                    GitHubã®ãƒªãƒã‚¸ãƒˆãƒªã«ã€Œãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚’ç½®ãã ã‘ã§ã€<br>
                                    Microsoftã®ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒãƒ¼(Runner)ãŒã‚ãªãŸã®ä»£ã‚ã‚Šã«ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã‚Œã¾ã™ã€‚
                                </p>
                            </div>
                        </div>

                        <div class="text-center pt-8">
                            <button onclick="loadStep(1)" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition-all transform hover:scale-105">
                                å·¥å ´ã®è¨­è¨ˆå›³ã‚’æ›¸ã
                            </button>
                        </div>
                    </div>
                `,
                hint: "CI (Continuous Integration) = ç¶™ç¶šçš„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€‚å¸¸ã«ãƒ“ãƒ«ãƒ‰ã¨ãƒ†ã‚¹ãƒˆã‚’ç¹°ã‚Šè¿”ã—ã¦å“è³ªã‚’ä¿ã¤ã“ã¨ã€‚"
            },
            {
                id: "config",
                title: "2. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«",
                content: `
                    <div class="max-w-5xl mx-auto space-y-6 animate-fade-in">
                        <div class="flex justify-between items-end">
                            <div>
                                <h2 class="text-2xl font-bold text-slate-800">.github/workflows/ci.yml</h2>
                                <p class="text-slate-600 mt-2">
                                    ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã«YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ãã¨ã€GitHubãŒãã‚Œã‚’èªè­˜ã—ã¦è‡ªå‹•å®Ÿè¡Œã—ã¾ã™ã€‚<br>
                                    ã€Œã„ã¤ã€ã€Œã©ã®ãƒã‚·ãƒ³ã§ã€ã€Œä½•ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã‹ã€ã‚’æ›¸ãã¾ã™ã€‚
                                </p>
                            </div>
                        </div>

                        <div class="grid lg:grid-cols-2 gap-8">
                            <!-- Virtual Editor -->
                            <div class="bg-gray-900 rounded-lg shadow-xl overflow-hidden flex flex-col h-[450px]">
                                <div class="flex bg-gray-800 text-gray-400 text-xs font-mono border-b border-gray-700">
                                    <div class="px-3 py-2 bg-gray-900 text-gray-200 border-t-2 border-green-500">ci.yml</div>
                                </div>
                                <div class="p-4 overflow-auto flex-grow font-mono text-sm text-gray-300 relative group">
                                    <button onclick="copyCode()" class="absolute top-4 right-4 bg-gray-700 hover:bg-gray-600 text-white px-2 py-1 rounded text-xs opacity-0 group-hover:opacity-100 transition-opacity">Copy</button>
                                    <pre id="code-display" class="language-yaml"></pre>
                                </div>
                            </div>

                            <!-- Explanation & Viz -->
                            <div class="space-y-6 flex flex-col">
                                <div id="explanation-box" class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex-grow">
                                    <h3 class="font-bold text-blue-700 mb-2">YAMLã®èª­ã¿æ–¹</h3>
                                    <ul class="space-y-4 text-sm text-slate-600">
                                        <li class="flex items-start">
                                            <span class="font-mono bg-slate-200 px-1 rounded mr-2 text-xs text-nowrap">on: push</span>
                                            <span>
                                                <strong>ãƒˆãƒªã‚¬ãƒ¼:</strong> èª°ã‹ãŒã‚³ãƒ¼ãƒ‰ã‚’Pushã—ãŸã‚‰èµ·å‹•ã™ã‚‹ã‚¹ã‚¤ãƒƒãƒã§ã™ã€‚
                                            </span>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="font-mono bg-slate-200 px-1 rounded mr-2 text-xs text-nowrap">runs-on: ubuntu</span>
                                            <span>
                                                <strong>å®Ÿè¡Œç’°å¢ƒ:</strong> MicrosoftãŒç”¨æ„ã—ãŸUbuntuã‚µãƒ¼ãƒãƒ¼ã‚’ä¸€æ™‚çš„ã«å€Ÿã‚Šã¾ã™ã€‚
                                            </span>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="font-mono bg-slate-200 px-1 rounded mr-2 text-xs text-nowrap">steps:</span>
                                            <span>
                                                <strong>æ‰‹é †:</strong>
                                                <ol class="list-decimal list-inside ml-2 mt-1 text-xs text-slate-500">
                                                    <li>ãƒªãƒã‚¸ãƒˆãƒªã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ (DL)</li>
                                                    <li><code>docker build</code> ã‚’å®Ÿè¡Œ</li>
                                                    <li>(æœ¬ç•ªãªã‚‰ã“ã“ã§ <code>docker push</code>)</li>
                                                </ol>
                                            </span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="text-right">
                             <button onclick="loadStep(2)" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-colors">
                                ãƒ•ã‚¡ã‚¤ãƒ«æº–å‚™OKï¼Pushã¸ â†’
                            </button>
                        </div>
                    </div>
                `,
                hint: "ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆå­—ä¸‹ã’ï¼‰ãŒå‘½ã§ã™ã€‚ã‚¹ãƒšãƒ¼ã‚¹ã®æ•°ãŒã‚ºãƒ¬ã‚‹ã¨å‹•ã‹ãªã„ã®ã§æ³¨æ„ï¼"
            },
            {
                id: "trigger",
                title: "3. Push & Trigger",
                content: `
                    <div class="max-w-4xl mx-auto space-y-8 animate-fade-in">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800">ã‚¹ã‚¤ãƒƒãƒã‚’æŠ¼ã™ï¼ˆGit Pushï¼‰</h2>
                            <p class="text-slate-600 mt-2">
                                ãƒ•ã‚¡ã‚¤ãƒ«ãŒã§ããŸã‚‰ã€GitHubã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆPushï¼‰ã—ã¾ã™ã€‚<br>
                                ã“ã‚ŒãŒå·¥å ´ã®èµ·å‹•ã‚¹ã‚¤ãƒƒãƒã«ãªã‚Šã¾ã™ã€‚
                            </p>
                        </div>

                        <!-- Terminal Simulator -->
                        <div class="bg-gray-900 rounded-lg shadow-2xl p-1 border border-gray-700 font-mono text-sm text-gray-300">
                            <div class="flex items-center px-4 py-2 bg-gray-800 rounded-t border-b border-gray-700 mb-2">
                                <span class="text-xs text-gray-400">Local Terminal</span>
                            </div>
                            <div class="p-4 h-64 overflow-y-auto" id="local-terminal">
                                <div class="mb-2">user@pc:~/my-app$ <span class="animate-pulse">_</span></div>
                            </div>
                        </div>

                        <!-- Controls -->
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 text-center">
                            <h3 class="font-bold text-lg text-slate-700 mb-4">å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦Push</h3>
                            <button onclick="simulatePush()" id="push-btn" class="bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition-transform active:scale-95 flex items-center justify-center mx-auto">
                                <span class="mr-2">ğŸš€</span> git push origin main
                            </button>
                            <p class="text-xs text-slate-400 mt-3">ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã¾ã™</p>
                        </div>
                    </div>
                `,
                hint: "å®Ÿéš›ã®é–‹ç™ºã§ã¯ VS Code ã®GUIã‹ã‚‰Pushã™ã‚‹ã“ã¨ã‚‚å¤šã„ã§ã™ãŒã€è£ã§ã¯ã“ã®ã‚³ãƒãƒ³ãƒ‰ãŒå‹•ã„ã¦ã„ã¾ã™ã€‚"
            },
            {
                id: "run",
                title: "4. è‡ªå‹•ãƒ“ãƒ«ãƒ‰ä½“é¨“ (Pipeline)",
                content: `
                    <div class="max-w-5xl mx-auto space-y-6 animate-fade-in">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800">å·¥å ´ãŒå‹•ãå‡ºã™</h2>
                            <p class="text-slate-600 mt-2">
                                Pushã‚’æ¤œçŸ¥ã—ã¦ã€ã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã®ã‚µãƒ¼ãƒãƒ¼ãŒå‹•ãå§‹ã‚ã¾ã—ãŸã€‚<br>
                                ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ­ã‚°ãŒæµã‚Œã‚‹æ§˜å­ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
                            </p>
                        </div>

                        <!-- Pipeline Visualizer -->
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 mb-4">
                            <div class="flex items-center justify-between max-w-3xl mx-auto relative">
                                <!-- Line Background -->
                                <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-200 -z-0"></div>
                                
                                <!-- Node 1 -->
                                <div id="node-1" class="pipeline-node relative z-10 w-12 h-12 rounded-full bg-white border-4 border-gray-300 flex items-center justify-center font-bold text-gray-500">
                                    1
                                    <div class="absolute -bottom-6 text-xs text-gray-500 w-24 text-center font-normal">Queued</div>
                                </div>
                                <!-- Line 1 -->
                                <div id="line-1" class="pipeline-line flex-grow h-1 bg-gray-200 z-0"></div>
                                
                                <!-- Node 2 -->
                                <div id="node-2" class="pipeline-node relative z-10 w-12 h-12 rounded-full bg-white border-4 border-gray-300 flex items-center justify-center font-bold text-gray-500">
                                    2
                                    <div class="absolute -bottom-6 text-xs text-gray-500 w-24 text-center font-normal">Checkout</div>
                                </div>
                                <!-- Line 2 -->
                                <div id="line-2" class="pipeline-line flex-grow h-1 bg-gray-200 z-0"></div>

                                <!-- Node 3 -->
                                <div id="node-3" class="pipeline-node relative z-10 w-12 h-12 rounded-full bg-white border-4 border-gray-300 flex items-center justify-center font-bold text-gray-500">
                                    3
                                    <div class="absolute -bottom-6 text-xs text-gray-500 w-24 text-center font-normal">Build</div>
                                </div>
                                
                                <!-- Line 3 -->
                                <div id="line-3" class="pipeline-line flex-grow h-1 bg-gray-200 z-0"></div>

                                <!-- Node 4 -->
                                <div id="node-4" class="pipeline-node relative z-10 w-12 h-12 rounded-full bg-white border-4 border-gray-300 flex items-center justify-center font-bold text-gray-500">
                                    4
                                    <div class="absolute -bottom-6 text-xs text-gray-500 w-24 text-center font-normal">Complete</div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Runner Terminal -->
                        <div class="bg-[#0d1117] rounded-lg shadow-2xl border border-gray-700 font-mono text-xs text-gray-300 p-1">
                            <div class="flex items-center px-4 py-2 bg-[#161b22] rounded-t border-b border-gray-700 mb-2">
                                <div class="w-3 h-3 rounded-full bg-red-500 mr-2"></div>
                                <div class="w-3 h-3 rounded-full bg-yellow-500 mr-2"></div>
                                <div class="w-3 h-3 rounded-full bg-green-500 mr-4"></div>
                                <span class="text-gray-400">gh-actions-runner-2b7a9f -- build-job</span>
                            </div>
                            <div class="p-4 h-64 overflow-y-auto" id="runner-logs">
                                <div class="text-gray-500 animate-pulse">Waiting for runner...</div>
                            </div>
                        </div>
                        
                        <div class="text-center mt-4 hidden" id="finish-btn-area">
                             <button onclick="loadStep(4)" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-colors animate-bounce">
                                çµæœã‚’ç¢ºèªã™ã‚‹ â†’
                            </button>
                        </div>
                    </div>
                `,
                hint: "æœ¬ç‰©ã®GitHub Actionsã§ã‚‚ã€ã“ã®ã‚ˆã†ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é»’ã„ç”»é¢ï¼ˆãƒ­ã‚°ï¼‰ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚"
            },
            {
                id: "verify",
                title: "5. æˆæœç‰©ç¢ºèª (Green Check)",
                content: `
                    <div class="max-w-4xl mx-auto space-y-6 animate-fade-in">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800">It works on the Cloud!</h2>
                            <p class="text-slate-600 mt-2">
                                ãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã—ã¾ã—ãŸã€‚GitHubä¸Šã§ã¯ã“ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
                            </p>
                        </div>

                        <!-- GitHub UI Simulator -->
                        <div class="bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden max-w-2xl mx-auto">
                            <div class="bg-[#f6f8fa] px-4 py-3 border-b border-gray-200 flex items-center">
                                <span class="font-bold text-sm text-slate-700 mr-2">my-app</span>
                                <span class="text-xs text-slate-500 bg-gray-200 px-2 py-0.5 rounded-full">Public</span>
                            </div>
                            <div class="p-4">
                                <div class="flex items-start space-x-3 mb-4">
                                    <div class="text-green-500 text-xl mt-1">âœ”</div>
                                    <div>
                                        <div class="font-bold text-slate-800 text-sm">Merge pull request #1 from feature/docker-ci</div>
                                        <div class="text-xs text-slate-500">2 minutes ago</div>
                                        
                                        <!-- Check Status -->
                                        <div class="mt-2 flex items-center space-x-2">
                                            <span class="text-green-500 text-lg">â—</span>
                                            <span class="text-sm font-bold text-slate-700">All checks passed</span>
                                        </div>
                                        <div class="ml-6 border-l-2 border-gray-200 pl-3 py-1 mt-1">
                                            <div class="flex items-center justify-between text-xs py-1">
                                                <span class="flex items-center">
                                                    <span class="w-4 h-4 bg-green-500 rounded-full flex items-center justify-center text-white text-[10px] mr-2">âœ“</span>
                                                    <strong>build</strong> (push)
                                                </span>
                                                <span class="text-slate-500">Details</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-green-50 p-6 rounded-xl border border-green-100 text-center">
                            <h3 class="text-xl font-bold text-green-800 mb-2">ğŸ‰ ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆ</h3>
                            <p class="text-green-700 text-sm mb-4">
                                ã“ã‚Œã§ã‚ãªãŸã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ãŸã³ã«<br>
                                <strong>ã€Œè‡ªå‹•çš„ã«æ¸…æ½”ãªç’°å¢ƒã§ãƒ†ã‚¹ãƒˆãƒ»ãƒ“ãƒ«ãƒ‰ã•ã‚Œã‚‹ã€</strong><br>
                                æœ€å¼·ã®çŠ¶æ…‹ã«ãªã‚Šã¾ã—ãŸã€‚
                            </p>
                            <button onclick="loadStep(5)" class="bg-slate-800 hover:bg-slate-900 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition-transform hover:scale-105">
                                ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã‚’å’æ¥­ã™ã‚‹
                            </button>
                        </div>
                    </div>
                `,
                hint: "ã€Œç·‘ã®ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ã€ã¯ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ã¨ã£ã¦ç²¾ç¥å®‰å®šå‰¤ã§ã™ã€‚"
            },
            {
                id: "done",
                title: "6. ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—å®Œäº†ï¼šæ¬¡ã®å†’é™ºã¸",
                content: `
                    <div class="max-w-3xl mx-auto space-y-8 animate-fade-in text-center">
                        <div>
                            <div class="text-6xl mb-4">ğŸ“</div>
                            <h2 class="text-3xl font-bold text-slate-800 mb-4">Container Master!</h2>
                            <p class="text-lg text-slate-600 mb-6">
                                ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼<br>Step 1ã‹ã‚‰5ã¾ã§ã€ã‚³ãƒ³ãƒ†ãƒŠæŠ€è¡“ã®åŸºç¤ã‹ã‚‰è‡ªå‹•åŒ–ã¾ã§ã‚’é§†ã‘æŠœã‘ã¾ã—ãŸã€‚
                            </p>
                        </div>

                        <div class="grid grid-cols-5 gap-2 text-xs text-white mb-8 max-w-lg mx-auto">
                            <div class="bg-blue-500 py-2 rounded">Step 1<br>Dockerfile</div>
                            <div class="bg-blue-600 py-2 rounded">Step 2<br>App</div>
                            <div class="bg-orange-500 py-2 rounded">Step 3<br>Compose</div>
                            <div class="bg-indigo-600 py-2 rounded">Step 4<br>DevEnv</div>
                            <div class="bg-green-600 py-2 rounded transform scale-110 shadow-lg border-2 border-white">Step 5<br>CI/CD</div>
                        </div>

                        <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200 text-left">
                            <h3 class="font-bold text-lg text-slate-700 mb-4 border-b pb-2">å¾—ã‚‰ã‚ŒãŸã‚¹ã‚­ãƒ«</h3>
                            <ul class="space-y-2 text-slate-600">
                                <li>âœ… <span class="font-bold">ç’°å¢ƒã®ã‚³ãƒ¼ãƒ‰åŒ–:</span> "It works on my machine" ã®æ’²æ»…</li>
                                <li>âœ… <span class="font-bold">ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹:</span> ã‚¢ãƒ—ãƒªã¨DBã®é€£æºãƒ»åˆ†é›¢</li>
                                <li>âœ… <span class="font-bold">é–‹ç™ºã®æ¨™æº–åŒ–:</span> ãƒãƒ¼ãƒ å…¨å“¡ãŒåŒã˜ã‚¨ãƒ‡ã‚£ã‚¿ç’°å¢ƒ</li>
                                <li>âœ… <span class="font-bold">é‹ç”¨ã®è‡ªå‹•åŒ–:</span> å¯ã¦ã„ã‚‹é–“ã«ãƒ“ãƒ«ãƒ‰å®Œäº†</li>
                            </ul>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6 rounded-xl mt-8">
                            <h4 class="font-bold mb-2">Next Stage: Kubernetes (k8s) & Cloud â˜ï¸</h4>
                            <p class="text-sm opacity-90 mb-4">
                                ä½œã£ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’ã€ä»Šåº¦ã¯ã€Œæ•°ç™¾å€‹åŒæ™‚ã«ç®¡ç†ã€ã—ã€Œä¸–ç•Œä¸­ã«å…¬é–‹ã€ã™ã‚‹æŠ€è¡“ãŒå¾…ã£ã¦ã„ã¾ã™ã€‚
                            </p>
                            <a href="#" class="inline-block bg-white text-purple-600 font-bold py-3 px-8 rounded-full shadow transition-transform hover:scale-105">
                                æœ€åˆã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
                            </a>
                        </div>
                    </div>
                `,
                hint: "æ—…ã¯ã¾ã å§‹ã¾ã£ãŸã°ã‹ã‚Šã§ã™ã€‚ã§ã‚‚ã€ã‚‚ã†åœ°å›³ï¼ˆåŸºç¤çŸ¥è­˜ï¼‰ã¯æŒã£ã¦ã„ã¾ã™ï¼"
            }
        ];

        const codeSnippet = `name: Docker Image CI

on:
  push:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - name: Build the Docker image
      run: docker build . --file Dockerfile --tag my-image-name:$(date +%s)`;

        // --- APP STATE ---
        let currentStep = 0;
        let simulationTimeouts = []; // Stores active animation timeouts

        // --- FUNCTIONS ---
        function loadStep(index) {
            clearSimulation(); // Reset any running animations
            currentStep = index;
            
            // Update UI Buttons
            document.querySelectorAll('.step-btn').forEach((btn, idx) => {
                if (idx === index) {
                    btn.classList.add('active');
                    btn.classList.remove('text-slate-600');
                    btn.classList.add('text-blue-700');
                } else {
                    btn.classList.remove('active');
                    btn.classList.add('text-slate-600');
                    btn.classList.remove('text-blue-700');
                }
            });

            // Update Progress Bar
            const progress = Math.round(((index) / (tutorialSteps.length - 1)) * 100);
            document.getElementById('progress-bar').style.width = `${progress}%`;
            document.getElementById('progress-text').innerText = `${progress}%`;

            // Inject Content
            const container = document.getElementById('main-content');
            container.innerHTML = tutorialSteps[index].content;
            document.getElementById('step-hint').innerText = tutorialSteps[index].hint;

            // Step-specific initializations
            if (index === 1) { // Config
                setTimeout(() => {
                    const display = document.getElementById('code-display');
                    if(display) {
                        display.textContent = codeSnippet;
                    }
                }, 100);
            }
            if (index === 3) { // Run Pipeline
                const id = setTimeout(() => {
                    runPipelineSimulation();
                }, 500);
                simulationTimeouts.push(id);
            }
        }

        // New function to clear running timeouts when switching steps
        function clearSimulation() {
            simulationTimeouts.forEach(id => clearTimeout(id));
            simulationTimeouts = [];
        }

        function copyCode() {
            navigator.clipboard.writeText(codeSnippet);
            alert("è¨­å®šã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
        }

        function simulatePush() {
            const btn = document.getElementById('push-btn');
            const term = document.getElementById('local-terminal');
            
            btn.disabled = true;
            btn.classList.add('opacity-50', 'cursor-not-allowed');
            btn.innerHTML = 'Pushing...';

            const logs = [
                "Enumerating objects: 5, done.",
                "Counting objects: 100% (5/5), done.",
                "Delta compression using up to 8 threads",
                "Compressing objects: 100% (3/3), done.",
                "Writing objects: 100% (3/3), 320 bytes | 320.00 KiB/s, done.",
                "Total 3 (delta 1), reused 0 (delta 0)",
                "To github.com:user/my-app.git",
                "   a1b2c3d..e5f6g7h  main -> main"
            ];

            let delay = 0;
            logs.forEach((log) => {
                delay += 400;
                const id = setTimeout(() => {
                    if(!term) return; // Safety Check
                    term.innerHTML += `<div class="text-white text-xs">${log}</div>`;
                    term.scrollTop = term.scrollHeight;
                }, delay);
                simulationTimeouts.push(id);
            });

            const finishId = setTimeout(() => {
                if(!term) return; // Safety Check
                term.innerHTML += `<div class="mb-2 mt-2">user@pc:~/my-app$ <span class="animate-pulse">_</span></div>`;
                term.scrollTop = term.scrollHeight;
                alert("Pushå®Œäº†ï¼GitHub ActionsãŒèµ·å‹•ã—ã¾ã—ãŸã€‚\nã€Œè‡ªå‹•ãƒ“ãƒ«ãƒ‰ä½“é¨“ã€ã¸é€²ã‚“ã§ãã ã•ã„ã€‚");
                btn.innerHTML = 'ğŸš€ git push origin main';
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
                loadStep(3); // Auto advance for better flow
            }, delay + 500);
            simulationTimeouts.push(finishId);
        }

        function runPipelineSimulation() {
            const logsArea = document.getElementById('runner-logs');
            const finishBtn = document.getElementById('finish-btn-area');
            
            // Safety Check: Exit if user navigated away
            if (!logsArea) return;

            const steps = [
                { node: 'node-1', line: 'line-1', delay: 500, log: "Starting workflow run..." },
                { node: 'node-1', line: 'line-1', delay: 1000, log: "Provisioning server..." },
                { node: 'node-2', line: 'line-1', delay: 2000, log: "Checkout repository..." },
                { node: 'node-2', line: 'line-2', delay: 3000, log: "Setting up Docker..." },
                { node: 'node-3', line: 'line-2', delay: 4000, log: "Step: Build Docker image" },
                { node: 'node-3', line: 'line-2', delay: 4500, log: " > docker build . -t my-app" },
                { node: 'node-3', line: 'line-2', delay: 5000, log: " > [1/3] FROM python:3.9" },
                { node: 'node-3', line: 'line-2', delay: 5500, log: " > [2/3] COPY . ." },
                { node: 'node-3', line: 'line-2', delay: 6000, log: " > [3/3] RUN pip install" },
                { node: 'node-3', line: 'line-3', delay: 7000, log: "Build completed successfully." },
                { node: 'node-4', line: 'line-3', delay: 8000, log: "Cleaning up..." },
                { node: 'node-4', line: 'line-3', delay: 8500, log: "Job completed." }
            ];

            // Reset UI
            logsArea.innerHTML = '';
            document.querySelectorAll('.pipeline-node').forEach(n => n.className = 'pipeline-node relative z-10 w-12 h-12 rounded-full bg-white border-4 border-gray-300 flex items-center justify-center font-bold text-gray-500');
            document.querySelectorAll('.pipeline-line').forEach(l => l.style.backgroundColor = '#d0d7de');

            // Animation Loop
            steps.forEach(s => {
                const id = setTimeout(() => {
                    // Critical Safety Check inside each timeout
                    const currentLogsArea = document.getElementById('runner-logs');
                    if (!currentLogsArea) return;

                    // Log
                    currentLogsArea.innerHTML += `<div class="text-gray-300 font-mono mb-1">> ${s.log}</div>`;
                    currentLogsArea.scrollTop = currentLogsArea.scrollHeight;

                    // Visual Node Update
                    if(s.node) {
                        const nodeEl = document.getElementById(s.node);
                        if (nodeEl) { // Check existence before accessing properties
                            // Make active
                            nodeEl.classList.remove('bg-white', 'text-gray-500', 'border-gray-300');
                            nodeEl.classList.add('running');
                            
                            // Previous nodes complete
                            if(s.node === 'node-2') markComplete('node-1', 'line-1');
                            if(s.node === 'node-3') markComplete('node-2', 'line-2');
                            if(s.node === 'node-4') markComplete('node-3', 'line-3');
                        }
                    }
                }, s.delay);
                simulationTimeouts.push(id);
            });

            // Final State
            const finalId = setTimeout(() => {
                // Safety check before final update
                const currentLogsArea = document.getElementById('runner-logs');
                if (!currentLogsArea) return;

                markComplete('node-4', null);
                currentLogsArea.innerHTML += `<div class="text-green-400 font-bold mt-2">Done!</div>`;
                if(finishBtn) finishBtn.classList.remove('hidden');
            }, 9000);
            simulationTimeouts.push(finalId);
        }

        function markComplete(nodeId, lineId) {
            const n = document.getElementById(nodeId);
            if (n) { // Check existence
                n.classList.remove('running', 'bg-white', 'text-gray-500', 'border-gray-300');
                n.classList.add('completed');
            }
            
            if(lineId) {
                const line = document.getElementById(lineId);
                if (line) { // Check existence
                    line.style.backgroundColor = '#2ea44f';
                }
            }
        }

        // --- INIT ---
        window.onload = () => {
            loadStep(0);
        };

    </script>
</body>
</html>